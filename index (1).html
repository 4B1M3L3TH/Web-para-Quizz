<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de Equipos</title>
    <style>
        /* General Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }
        
        /* Card Styles */
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .card-header {
            padding: 15px;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .card-content {
            padding: 20px;
        }
        
        /* Team Setup */
        .setup-form {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        /* Teams Display */
        .teams-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .team-card {
            flex: 1;
            min-width: 250px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .team-card.selected {
            border: 3px solid #4c1d95;
        }
        
        .team-1 .card-header {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .team-2 .card-header {
            background-color: #fee2e2;
            color: #b91c1c;
        }
        
        .team-score {
            font-size: 3rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .team-status {
            margin-top: 10px;
            font-weight: 500;
            height: 24px;
        }
        
        .hand-raised {
            color: #059669;
        }
        
        .answering {
            color: #4f46e5;
        }
        
        /* Question Card */
        .question-card {
            margin-top: 30px;
        }
        
        .question-text {
            background-color: #f3f4f6;
            padding: 20px;
            border-radius: 6px;
            font-size: 1.2rem;
            text-align: center;
            margin-bottom: 20px;
        }
        
        /* Timer */
        .timer-container {
            margin: 15px 0;
            text-align: center;
        }
        
        .timer {
            font-size: 2rem;
            font-weight: bold;
            color: #4f46e5;
        }
        
        .timer.warning {
            color: #f59e0b;
        }
        
        .timer.danger {
            color: #ef4444;
        }
        
        /* Answer Options */
        .answer-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .answer-option {
            padding: 15px;
            background-color: #f3f4f6;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .answer-option:hover {
            background-color: #e5e7eb;
        }
        
        .answer-option.selected {
            background-color: #dbeafe;
            border-color: #93c5fd;
        }
        
        .answer-option.correct {
            background-color: #d1fae5;
            border-color: #34d399;
            color: #065f46;
        }
        
        .answer-option.incorrect {
            background-color: #fee2e2;
            border-color: #f87171;
            color: #b91c1c;
        }
        
        /* Buttons */
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .btn-primary {
            background-color: #4f46e5;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #4338ca;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid #4f46e5;
            color: #4f46e5;
        }
        
        .btn-outline:hover {
            background-color: #f5f3ff;
        }
        
        .btn-success {
            background-color: #10b981;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #059669;
        }
        
        .btn-danger {
            background-color: #ef4444;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #dc2626;
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        /* Button Groups */
        .btn-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .btn-group .btn {
            flex: 1;
        }
        
        /* Controls */
        .controls {
            margin-top: 20px;
        }
        
        .control-section {
            margin-bottom: 20px;
        }
        
        .control-title {
            text-align: center;
            margin-bottom: 15px;
            font-weight: 500;
        }
        
        .center-btn {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
        
        /* Game Instructions */
        .game-instructions {
            text-align: center;
            margin-bottom: 15px;
            font-weight: 500;
            color: #4b5563;
        }
        
        /* Game Summary */
        .game-summary {
            margin-top: 20px;
        }
        
        .summary-title {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            color: #4f46e5;
        }
        
        .winner-announcement {
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 30px;
            padding: 15px;
            border-radius: 8px;
        }
        
        .winner-team-1 {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .winner-team-2 {
            background-color: #fee2e2;
            color: #b91c1c;
        }
        
        .winner-tie {
            background-color: #f3f4f6;
            color: #4b5563;
        }
        
        .final-scores {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
        }
        
        .final-score {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            min-width: 200px;
        }
        
        .final-score-team-1 {
            background-color: #dbeafe;
        }
        
        .final-score-team-2 {
            background-color: #fee2e2;
        }
        
        .final-score-name {
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .final-score-points {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .history-title {
            font-size: 1.3rem;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
        }
        
        .history-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .team-history {
            flex: 1;
            min-width: 300px;
        }
        
        .team-history-header {
            font-weight: bold;
            padding: 10px;
            border-radius: 6px 6px 0 0;
            text-align: center;
        }
        
        .team-1-header {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .team-2-header {
            background-color: #fee2e2;
            color: #b91c1c;
        }
        
        .history-list {
            list-style-type: none;
            border: 1px solid #e5e7eb;
            border-radius: 0 0 6px 6px;
        }
        
        .history-item {
            padding: 12px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .history-question {
            flex: 1;
        }
        
        .history-result {
            margin-left: 10px;
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 4px;
        }
        
        .history-correct {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .history-incorrect {
            background-color: #fee2e2;
            color: #b91c1c;
        }
        
        .history-no-answer {
            background-color: #f3f4f6;
            color: #4b5563;
        }
        
        .restart-btn {
            margin-top: 30px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .teams-container {
                flex-direction: column;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .answer-options {
                grid-template-columns: 1fr;
            }
            
            .final-scores {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .history-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Quiz de Equipos</h1>
        
        <!-- Team Setup Form -->
        <div id="setup-section" class="card">
            <div class="card-header">Configuración de Equipos</div>
            <div class="card-content">
                <div class="setup-form">
                    <div class="form-group">
                        <label for="team1-name">Nombre del Equipo 1</label>
                        <input type="text" id="team1-name" value="Equipo 1">
                    </div>
                    <div class="form-group">
                        <label for="team2-name">Nombre del Equipo 2</label>
                        <input type="text" id="team2-name" value="Equipo 2">
                    </div>
                    <div class="form-group">
                        <label for="timer-seconds">Tiempo para responder (segundos)</label>
                        <input type="number" id="timer-seconds" value="30" min="5" max="120">
                    </div>
                    <button id="confirm-teams" class="btn btn-primary btn-block">Confirmar Equipos</button>
                </div>
            </div>
        </div>
        
        <!-- Game Section (Hidden initially) -->
        <div id="game-section" style="display: none;">
            <!-- Teams Display -->
            <div class="teams-container">
                <!-- Team 1 -->
                <div id="team-1-card" class="team-card team-1 card">
                    <div class="card-header" id="team-1-header">Equipo 1</div>
                    <div class="card-content">
                        <div id="team-1-score" class="team-score">0</div>
                        <div id="team-1-status" class="team-status">Esperando inicio del juego</div>
                    </div>
                </div>
                
                <!-- Team 2 -->
                <div id="team-2-card" class="team-card team-2 card">
                    <div class="card-header" id="team-2-header">Equipo 2</div>
                    <div class="card-content">
                        <div id="team-2-score" class="team-score">0</div>
                        <div id="team-2-status" class="team-status">Esperando inicio del juego</div>
                    </div>
                </div>
            </div>
            
            <!-- Question and Controls -->
            <div class="card question-card">
                <div class="card-header">Pregunta Actual</div>
                <div class="card-content">
                    <!-- Start Game Button (shown initially) -->
                    <div id="start-game-section">
                        <button id="start-game" class="btn btn-primary btn-block">Iniciar Juego</button>
                        <p style="text-align: center; margin-top: 15px;">Presiona el botón para comenzar el juego y mostrar la primera pregunta.</p>
                    </div>
                    
                    <!-- Question Section (Hidden initially) -->
                    <div id="question-section" style="display: none;">
                        <!-- Timer -->
                        <div class="timer-container">
                            <div id="timer" class="timer">30</div>
                        </div>
                        
                        <!-- Question Text -->
                        <div id="current-question" class="question-text">
                            La pregunta aparecerá aquí
                        </div>
                        
                        <!-- Game Instructions -->
                        <div id="game-instructions" class="game-instructions">
                            Haz clic en el equipo que levantó la mano primero
                        </div>
                        
                        <!-- Answer Options -->
                        <div id="answer-options" class="answer-options" style="display: none;">
                            <!-- Options will be added dynamically -->
                        </div>
                        
                        <!-- Next Question Button -->
                        <div class="center-btn">
                            <button id="next-question" class="btn btn-outline">
                                Siguiente Pregunta
                            </button>
                        </div>
                    </div>
                    
                    <!-- Game Summary (Hidden initially) -->
                    <div id="game-summary" style="display: none;">
                        <div class="summary-title">Resumen del Juego</div>
                        
                        <!-- Winner Announcement -->
                        <div id="winner-announcement" class="winner-announcement">
                            <!-- Will be filled dynamically -->
                        </div>
                        
                        <!-- Final Scores -->
                        <div class="final-scores">
                            <div class="final-score final-score-team-1">
                                <div id="final-team-1-name" class="final-score-name">Equipo 1</div>
                                <div id="final-team-1-score" class="final-score-points">0</div>
                            </div>
                            
                            <div class="final-score final-score-team-2">
                                <div id="final-team-2-name" class="final-score-name">Equipo 2</div>
                                <div id="final-team-2-score" class="final-score-points">0</div>
                            </div>
                        </div>
                        
                        <!-- Answer History -->
                        <div class="history-title">Historial de Respuestas</div>
                        
                        <div class="history-container">
                            <!-- Team 1 History -->
                            <div class="team-history">
                                <div id="team-1-history-header" class="team-history-header team-1-header">
                                    Equipo 1
                                </div>
                                <ul id="team-1-history" class="history-list">
                                    <!-- Will be filled dynamically -->
                                </ul>
                            </div>
                            
                            <!-- Team 2 History -->
                            <div class="team-history">
                                <div id="team-2-history-header" class="team-history-header team-2-header">
                                    Equipo 2
                                </div>
                                <ul id="team-2-history" class="history-list">
                                    <!-- Will be filled dynamically -->
                                </ul>
                            </div>
                        </div>
                        
                        <!-- Restart Button -->
                        <div class="center-btn restart-btn">
                            <button id="restart-game" class="btn btn-primary">
                                Jugar de Nuevo
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Quiz State
        const state = {
            team1: {
                name: "Equipo 1",
                score: 0,
                hasAnswered: false,
                isAnswering: false,
                history: [] // Array to store answer history
            },
            team2: {
                name: "Equipo 2",
                score: 0,
                hasAnswered: false,
                isAnswering: false,
                history: [] // Array to store answer history
            },
            gameStarted: false,
            currentQuestion: null,
            currentQuestionIndex: 0,
            selectedTeam: null,
            selectedAnswer: null,
            incorrectAnswers: [], // Track incorrect answers
            timerSeconds: 30,
            timerInterval: null,
            timeRemaining: 30,
            waitingForTeamSelection: false,
            questions: [
                {
                    question: "¿Cuál es la capital de Francia?",
                    options: ["Madrid", "París", "Londres", "Berlín"],
                    correctAnswer: 1
                },
                {
                    question: "¿En qué año comenzó la Segunda Guerra Mundial?",
                    options: ["1914", "1939", "1945", "1918"],
                    correctAnswer: 1
                },
                {
                    question: "¿Cuál es el planeta más grande del sistema solar?",
                    options: ["Tierra", "Marte", "Júpiter", "Saturno"],
                    correctAnswer: 2
                },
                {
                    question: "¿Quién escribió Don Quijote de la Mancha?",
                    options: ["Federico García Lorca", "Miguel de Cervantes", "Gabriel García Márquez", "Pablo Neruda"],
                    correctAnswer: 1
                },
                {
                    question: "¿Cuál es el elemento químico más abundante en el universo?",
                    options: ["Oxígeno", "Carbono", "Hidrógeno", "Helio"],
                    correctAnswer: 2
                },
                {
                    question: "¿Cuántos huesos tiene el cuerpo humano adulto?",
                    options: ["206", "186", "226", "246"],
                    correctAnswer: 0
                },
                {
                    question: "¿Cuál es el río más largo del mundo?",
                    options: ["Amazonas", "Nilo", "Misisipi", "Yangtsé"],
                    correctAnswer: 0
                },
                {
                    question: "¿Quién pintó La Mona Lisa?",
                    options: ["Vincent van Gogh", "Pablo Picasso", "Leonardo da Vinci", "Miguel Ángel"],
                    correctAnswer: 2
                },
                {
                    question: "¿Cuál es el océano más grande?",
                    options: ["Atlántico", "Índico", "Pacífico", "Ártico"],
                    correctAnswer: 2
                },
                {
                    question: "¿Cuál es el animal terrestre más rápido?",
                    options: ["León", "Guepardo", "Tigre", "Gacela"],
                    correctAnswer: 1
                }
            ],
            availableQuestions: [],
            usedQuestions: [] // To keep track of questions that have been used
        };
        
        // DOM Elements
        const elements = {
            setupSection: document.getElementById('setup-section'),
            gameSection: document.getElementById('game-section'),
            team1NameInput: document.getElementById('team1-name'),
            team2NameInput: document.getElementById('team2-name'),
            timerSecondsInput: document.getElementById('timer-seconds'),
            confirmTeamsBtn: document.getElementById('confirm-teams'),
            team1Header: document.getElementById('team-1-header'),
            team2Header: document.getElementById('team-2-header'),
            team1Score: document.getElementById('team-1-score'),
            team2Score: document.getElementById('team-2-score'),
            team1Status: document.getElementById('team-1-status'),
            team2Status: document.getElementById('team-2-status'),
            team1Card: document.getElementById('team-1-card'),
            team2Card: document.getElementById('team-2-card'),
            startGameSection: document.getElementById('start-game-section'),
            startGameBtn: document.getElementById('start-game'),
            questionSection: document.getElementById('question-section'),
            currentQuestion: document.getElementById('current-question'),
            answerOptions: document.getElementById('answer-options'),
            gameInstructions: document.getElementById('game-instructions'),
            nextQuestionBtn: document.getElementById('next-question'),
            timer: document.getElementById('timer'),
            gameSummary: document.getElementById('game-summary'),
            winnerAnnouncement: document.getElementById('winner-announcement'),
            finalTeam1Name: document.getElementById('final-team-1-name'),
            finalTeam2Name: document.getElementById('final-team-2-name'),
            finalTeam1Score: document.getElementById('final-team-1-score'),
            finalTeam2Score: document.getElementById('final-team-2-score'),
            team1HistoryHeader: document.getElementById('team-1-history-header'),
            team2HistoryHeader: document.getElementById('team-2-history-header'),
            team1History: document.getElementById('team-1-history'),
            team2History: document.getElementById('team-2-history'),
            restartGameBtn: document.getElementById('restart-game')
        };
        
        // Initialize the game
        function init() {
            // Copy questions to available questions
            state.availableQuestions = [...state.questions];
            state.usedQuestions = [];
            
            // Reset team histories
            state.team1.history = [];
            state.team2.history = [];
            
            // Set up event listeners
            elements.confirmTeamsBtn.addEventListener('click', setupTeams);
            elements.startGameBtn.addEventListener('click', startGame);
            elements.team1Card.addEventListener('click', () => selectTeamToAnswer(1));
            elements.team2Card.addEventListener('click', () => selectTeamToAnswer(2));
            elements.nextQuestionBtn.addEventListener('click', nextQuestion);
            elements.restartGameBtn.addEventListener('click', restartGame);
        }
        
        // Set up team names and timer
        function setupTeams() {
            const team1Name = elements.team1NameInput.value.trim();
            const team2Name = elements.team2NameInput.value.trim();
            const timerSeconds = parseInt(elements.timerSecondsInput.value);
            
            if (team1Name === "" || team2Name === "") {
                alert("Por favor ingresa nombres para ambos equipos");
                return;
            }
            
            if (isNaN(timerSeconds) || timerSeconds < 5 || timerSeconds > 120) {
                alert("Por favor ingresa un tiempo válido entre 5 y 120 segundos");
                return;
            }
            
            // Update state
            state.team1.name = team1Name;
            state.team2.name = team2Name;
            state.timerSeconds = timerSeconds;
            state.timeRemaining = timerSeconds;
            
            // Reset scores
            state.team1.score = 0;
            state.team2.score = 0;
            
            // Update UI
            elements.team1Header.textContent = team1Name;
            elements.team2Header.textContent = team2Name;
            elements.timer.textContent = timerSeconds;
            elements.team1Score.textContent = "0";
            elements.team2Score.textContent = "0";
            
            // Show game section
            elements.setupSection.style.display = 'none';
            elements.gameSection.style.display = 'block';
        }
        
        // Start the game
        function startGame() {
            state.gameStarted = true;
            
            // Update UI
            elements.startGameSection.style.display = 'none';
            elements.questionSection.style.display = 'block';
            elements.gameSummary.style.display = 'none';
            
            // Select first question
            selectRandomQuestion();
        }
        
        // Select a random question
        function selectRandomQuestion() {
            if (state.availableQuestions.length === 0) {
                // No more questions, show game summary
                showGameSummary();
                return;
            }
            
            const randomIndex = Math.floor(Math.random() * state.availableQuestions.length);
            state.currentQuestion = state.availableQuestions[randomIndex];
            state.currentQuestionIndex = state.questions.findIndex(q => q.question === state.currentQuestion.question);
            
            // Remove the selected question from available and add to used
            state.availableQuestions.splice(randomIndex, 1);
            state.usedQuestions.push(state.currentQuestion);
            
            // Update UI
            elements.currentQuestion.textContent = state.currentQuestion.question;
            
            // Clear and create answer options
            elements.answerOptions.innerHTML = '';
            state.currentQuestion.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'answer-option';
                optionElement.textContent = option;
                optionElement.dataset.index = index;
                optionElement.addEventListener('click', () => selectAnswer(index));
                elements.answerOptions.appendChild(optionElement);
            });
            
            // Reset round
            resetRound();
        }
        
        // Reset the current round
        function resetRound() {
            // Reset state
            state.team1.hasAnswered = false;
            state.team1.isAnswering = false;
            state.team2.hasAnswered = false;
            state.team2.isAnswering = false;
            state.selectedTeam = null;
            state.selectedAnswer = null;
            state.incorrectAnswers = [];
            state.waitingForTeamSelection = true;
            
            // Update UI
            elements.team1Status.textContent = "";
            elements.team2Status.textContent = "";
            elements.team1Card.classList.remove('selected');
            elements.team2Card.classList.remove('selected');
            
            // Show instructions, hide answer options
            elements.gameInstructions.style.display = 'block';
            elements.gameInstructions.textContent = 'Haz clic en el equipo que levantó la mano primero';
            elements.answerOptions.style.display = 'none';
            
            // Reset answer options
            const answerOptions = document.querySelectorAll('.answer-option');
            answerOptions.forEach(option => {
                option.classList.remove('selected');
                option.classList.remove('correct');
                option.classList.remove('incorrect');
                option.style.pointerEvents = 'auto';
            });
            
            // Reset timer
            stopTimer();
            state.timeRemaining = state.timerSeconds;
            elements.timer.textContent = state.timeRemaining;
            elements.timer.className = 'timer';
        }
        
        // Select team to answer (when clicking on team card)
        function selectTeamToAnswer(team) {
            // Only allow selection if waiting for team selection
            if (!state.waitingForTeamSelection) return;
            
            // If team has already answered, don't  return;
            
            // If team has already answered, don't allow selection
            if ((team === 1 && state.team1.hasAnswered) || 
                (team === 2 && state.team2.hasAnswered)) {
                return;
            }
            
            state.selectedTeam = team;
            state.waitingForTeamSelection = false;
            
            // Update UI
            if (team === 1) {
                state.team1.isAnswering = true;
                elements.team1Card.classList.add('selected');
                elements.team1Status.textContent = "Respondiendo...";
                elements.team1Status.classList.add('answering');
                
                // Reset team 2 status if it was previously selected
                elements.team2Card.classList.remove('selected');
                elements.team2Status.classList.remove('answering');
            } else {
                state.team2.isAnswering = true;
                elements.team2Card.classList.add('selected');
                elements.team2Status.textContent = "Respondiendo...";
                elements.team2Status.classList.add('answering');
                
                // Reset team 1 status if it was previously selected
                elements.team1Card.classList.remove('selected');
                elements.team1Status.classList.remove('answering');
            }
            
            // Show answer options
            elements.gameInstructions.textContent = `${team === 1 ? state.team1.name : state.team2.name} está respondiendo`;
            elements.answerOptions.style.display = 'grid';
            
            // Start timer
            startTimer();
        }
        
        // Select an answer
        function selectAnswer(index) {
            if (!state.selectedTeam) return;
            
            state.selectedAnswer = index;
            
            // Update UI
            const answerOptions = document.querySelectorAll('.answer-option');
            answerOptions.forEach(option => {
                option.classList.remove('selected');
            });
            
            // Check if the answer is correct
            if (index === state.currentQuestion.correctAnswer) {
                // Mark as correct (green)
                answerOptions[index].classList.add('correct');
                handleCorrectAnswer();
            } else {
                // Mark only the selected answer as incorrect (red)
                answerOptions[index].classList.add('incorrect');
                
                // Add to incorrect answers
                state.incorrectAnswers.push(index);
                
                // Mark the team as having answered
                if (state.selectedTeam === 1) {
                    state.team1.hasAnswered = true;
                    state.team1.isAnswering = false;
                } else {
                    state.team2.hasAnswered = true;
                    state.team2.isAnswering = false;
                }
                
                handleIncorrectAnswer();
            }
        }
        
        // Handle correct answer
        function handleCorrectAnswer() {
            // Stop timer
            stopTimer();
            
            // Award points
            if (state.selectedTeam === 1) {
                state.team1.score += 10;
                elements.team1Score.textContent = state.team1.score;
                elements.team1Status.textContent = "¡Respuesta correcta!";
                
                // Add to history
                state.team1.history.push({
                    question: state.currentQuestion.question,
                    answer: state.currentQuestion.options[state.currentQuestion.correctAnswer],
                    correct: true
                });
            } else {
                state.team2.score += 10;
                elements.team2Score.textContent = state.team2.score;
                elements.team2Status.textContent = "¡Respuesta correcta!";
                
                // Add to history
                state.team2.history.push({
                    question: state.currentQuestion.question,
                    answer: state.currentQuestion.options[state.currentQuestion.correctAnswer],
                    correct: true
                });
            }
            
            // Disable answer options
            const answerOptions = document.querySelectorAll('.answer-option');
            answerOptions.forEach(option => {
                option.style.pointerEvents = 'none';
            });
            
            // Update instructions
            elements.gameInstructions.textContent = "¡Respuesta correcta!";
            
            // Wait 2 seconds before moving to next question
            setTimeout(() => {
                selectRandomQuestion();
            }, 2000);
        }
        
        // Handle incorrect answer
        function handleIncorrectAnswer() {
            // Stop timer
            stopTimer();
            
            // Update UI for incorrect answer
            if (state.selectedTeam === 1) {
                elements.team1Status.textContent = "Respuesta incorrecta";
                elements.team1Status.classList.remove('answering');
                
                // Add to history
                state.team1.history.push({
                    question: state.currentQuestion.question,
                    answer: state.currentQuestion.options[state.selectedAnswer],
                    correct: false
                });
            } else {
                elements.team2Status.textContent = "Respuesta incorrecta";
                elements.team2Status.classList.remove('answering');
                
                // Add to history
                state.team2.history.push({
                    question: state.currentQuestion.question,
                    answer: state.currentQuestion.options[state.selectedAnswer],
                    correct: false
                });
            }
            
            // Check if both teams have answered incorrectly
            if (state.team1.hasAnswered && state.team2.hasAnswered) {
                // Both teams have answered incorrectly, show the correct answer
                const answerOptions = document.querySelectorAll('.answer-option');
                answerOptions[state.currentQuestion.correctAnswer].classList.add('correct');
                
                // Disable answer options
                answerOptions.forEach(option => {
                    option.style.pointerEvents = 'none';
                });
                
                // Update instructions
                elements.gameInstructions.textContent = "Ambos equipos respondieron incorrectamente";
                
                // Wait 2 seconds before moving to next question
                setTimeout(() => {
                    selectRandomQuestion();
                }, 2000);
            } else {
                // Give the opportunity to the other team
                const otherTeam = state.selectedTeam === 1 ? 2 : 1;
                
                // Update instructions
                elements.gameInstructions.textContent = `Turno de ${otherTeam === 1 ? state.team1.name : state.team2.name}`;
                
                // Reset for other team selection
                state.waitingForTeamSelection = true;
                
                // If the other team is the only one left, automatically select it
                if ((otherTeam === 1 && !state.team1.hasAnswered) || 
                    (otherTeam === 2 && !state.team2.hasAnswered)) {
                    
                    // Give a short pause before auto-selecting the other team
                    setTimeout(() => {
                        selectTeamToAnswer(otherTeam);
                    }, 1000);
                }
            }
        }
        
        // Start the timer
        function startTimer() {
            // Reset timer
            stopTimer();
            state.timeRemaining = state.timerSeconds;
            elements.timer.textContent = state.timeRemaining;
            elements.timer.className = 'timer';
            
            // Start interval
            state.timerInterval = setInterval(() => {
                state.timeRemaining--;
                elements.timer.textContent = state.timeRemaining;
                
                // Add warning classes
                if (state.timeRemaining <= 10) {
                    elements.timer.classList.add('warning');
                }
                if (state.timeRemaining <= 5) {
                    elements.timer.classList.remove('warning');
                    elements.timer.classList.add('danger');
                }
                
                // Time's up
                if (state.timeRemaining <= 0) {
                    stopTimer();
                    handleTimeUp();
                }
            }, 1000);
        }
        
        // Stop the timer
        function stopTimer() {
            clearInterval(state.timerInterval);
        }
        
        // Handle time up
        function handleTimeUp() {
            // Consider it as an incorrect answer
            if (state.selectedTeam === 1) {
                elements.team1Status.textContent = "¡Tiempo agotado!";
                elements.team1Status.classList.remove('answering');
                state.team1.hasAnswered = true;
                state.team1.isAnswering = false;
                
                // Add to history
                state.team1.history.push({
                    question: state.currentQuestion.question,
                    answer: "Sin respuesta (tiempo agotado)",
                    correct: false
                });
            } else {
                elements.team2Status.textContent = "¡Tiempo agotado!";
                elements.team2Status.classList.remove('answering');
                state.team2.hasAnswered = true;
                state.team2.isAnswering = false;
                
                // Add to history
                state.team2.history.push({
                    question: state.currentQuestion.question,
                    answer: "Sin respuesta (tiempo agotado)",
                    correct: false
                });
            }
            
            // Check if both teams have had a chance
            if (state.team1.hasAnswered && state.team2.hasAnswered) {
                // Show the correct answer
                const answerOptions = document.querySelectorAll('.answer-option');
                answerOptions[state.currentQuestion.correctAnswer].classList.add('correct');
                
                // Update instructions
                elements.gameInstructions.textContent = "Ambos equipos se quedaron sin tiempo";
                
                // Wait 2 seconds before moving to next question
                setTimeout(() => {
                    selectRandomQuestion();
                }, 2000);
            } else {
                // Give the opportunity to the other team
                const otherTeam = state.selectedTeam === 1 ? 2 : 1;
                
                // Update instructions
                elements.gameInstructions.textContent = `Turno de ${otherTeam === 1 ? state.team1.name : state.team2.name}`;
                
                // Reset for other team selection
                state.waitingForTeamSelection = true;
                
                // If the other team is the only one left, automatically select it
                if ((otherTeam === 1 && !state.team1.hasAnswered) || 
                    (otherTeam === 2 && !state.team2.hasAnswered)) {
                    
                    // Give a short pause before auto-selecting the other team
                    setTimeout(() => {
                        selectTeamToAnswer(otherTeam);
                    }, 1000);
                }
            }
        }
        
        // Move to next question without awarding points
        function nextQuestion() {
            stopTimer();
            
            // Add to history for teams that didn't answer
            if (!state.team1.hasAnswered && !state.team1.isAnswering) {
                state.team1.history.push({
                    question: state.currentQuestion.question,
                    answer: "Sin respuesta",
                    correct: false
                });
            }
            
            if (!state.team2.hasAnswered && !state.team2.isAnswering) {
                state.team2.history.push({
                    question: state.currentQuestion.question,
                    answer: "Sin respuesta",
                    correct: false
                });
            }
            
            selectRandomQuestion();
        }
        
        // Show game summary
        function showGameSummary() {
            // Hide question section
            elements.questionSection.style.display = 'none';
            
            // Show summary section
            elements.gameSummary.style.display = 'block';
            
            // Update team names
            elements.finalTeam1Name.textContent = state.team1.name;
            elements.finalTeam2Name.textContent = state.team2.name;
            elements.team1HistoryHeader.textContent = state.team1.name;
            elements.team2HistoryHeader.textContent = state.team2.name;
            
            // Update final scores
            elements.finalTeam1Score.textContent = state.team1.score;
            elements.finalTeam2Score.textContent = state.team2.score;
            
            // Determine winner
            let winnerMessage = '';
            let winnerClass = '';
            
            if (state.team1.score > state.team2.score) {
                winnerMessage = `¡${state.team1.name} ha ganado!`;
                winnerClass = 'winner-team-1';
            } else if (state.team2.score > state.team1.score) {
                winnerMessage = `¡${state.team2.name} ha ganado!`;
                winnerClass = 'winner-team-2';
            } else {
                winnerMessage = '¡Empate!';
                winnerClass = 'winner-tie';
            }
            
            elements.winnerAnnouncement.textContent = winnerMessage;
            elements.winnerAnnouncement.className = `winner-announcement ${winnerClass}`;
            
            // Generate history lists
            generateHistoryList(state.team1.history, elements.team1History);
            generateHistoryList(state.team2.history, elements.team2History);
        }
        
        // Generate history list
        function generateHistoryList(history, listElement) {
            // Clear list
            listElement.innerHTML = '';
            
            // Check if history is empty
            if (history.length === 0) {
                const emptyItem = document.createElement('li');
                emptyItem.className = 'history-item';
                emptyItem.textContent = 'No hay respuestas registradas';
                listElement.appendChild(emptyItem);
                return;
            }
            
            // Add each history item
            history.forEach(item => {
                const historyItem = document.createElement('li');
                historyItem.className = 'history-item';
                
                const questionSpan = document.createElement('span');
                questionSpan.className = 'history-question';
                questionSpan.textContent = item.question;
                
                const resultSpan = document.createElement('span');
                if (item.correct) {
                    resultSpan.className = 'history-result history-correct';
                    resultSpan.textContent = '✓';
                } else {
                    resultSpan.className = 'history-result history-incorrect';
                    resultSpan.textContent = '✗';
                }
                
                historyItem.appendChild(questionSpan);
                historyItem.appendChild(resultSpan);
                
                // Add tooltip with the answer
                historyItem.title = `Respuesta: ${item.answer}`;
                
                listElement.appendChild(historyItem);
            });
        }
        
        // Restart game
        function restartGame() {
            // Reset scores
            state.team1.score = 0;
            state.team2.score = 0;
            
            // Reset histories
            state.team1.history = [];
            state.team2.history = [];
            
            // Reset questions
            state.availableQuestions = [...state.questions];
            state.usedQuestions = [];
            
            // Update UI
            elements.team1Score.textContent = "0";
            elements.team2Score.textContent = "0";
            
            // Start game again
            startGame();
        }
        
        // Initialize the game when the page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>